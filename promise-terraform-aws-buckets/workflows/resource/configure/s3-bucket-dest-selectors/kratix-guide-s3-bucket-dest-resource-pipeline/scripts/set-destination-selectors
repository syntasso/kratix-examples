#!/usr/bin/env python3
import kratix_sdk as ks
import sys
from typing import List 

def resource_configure() -> int:
    sdk = ks.KratixSDK()
    resource = sdk.read_resource_input()

    team = resource.get_value("spec.team")
    if not team or not isinstance(team, str):
        print("Error: spec.team is required and must be a non-empty string", file=sys.stderr)
        return 1

    selectors: List[ks.DestinationSelector] = [
        ks.DestinationSelector(match_labels={
            "workspace": team
        })
    ]
    
    sdk.write_destination_selectors(selectors)
    print(f"Destination configured for team: {team}")
    return 0

def main():
    exit_code = resource_configure()
    sys.exit(exit_code)

if __name__ == '__main__':
    main()